# SQL 기본 및 활용
# SQL 활용
## 표준 조인
### 1)관계 대수
> 관계형 데이터 베이스에서 원하는 정보를 어떻게 찾아서 표현 하는지 기술하는 절차적 언어

#### 일반집합 연산자
>합집합, 교집합, 차집합, 곱집합의 수학적 집한 연산자

|유형|설명|
|:-:|-|
|합집합(Union)|수학적 합집합으로써, `UNION`(중복 부분을 제거해서 표현) 혹은 `UNION ALL`(중복 부분을 그대로 표현) 키워드 사용|
|교집합(Intersect)|수학적 교집합으로써, `INTERSECT` 키워드 사용|
|차집합(Diffrence)|수학적 차집합으로써, `EXCEPT`(SQL 표준) 혹은 `MINUS`(ORACLE)키워드 사용|
|곱집합(Product)|수학적 공집합으로써, `CROSS JOIN`키워드 사용|
#### 순수 관계 연산자
>관계형 데이터베이스를 구현하기 위한 관계 연산자

|유형|설명|
|:-:|-|
|Select|조건을 만족하는 레코드를 찾기 위해, `WHERE`키워드 사용|
|Project|필요한 속성을 추출하기 위해서, `SELECT` 키워드 사용|
|Join|두 개의 릴레이션을 하나로 합치기 위해서, `JOIN`키워드 사용|
|Divide|나눗셈과 비슷한 개념이지만, SQL에서는 사용되지 않음|
### 2)표준 조인의 유형
> ANSI/ISO표준 SQL에서 규정한 조인기법
- 내부/외부/크로스/자연 조인 혹은 표준 조건절인 ON, USING을 통해 JOIN조건을 FROM절에 명시적으로 정의할 수 있다.

|유형|설명|
|:-:|-|
|내부 조인(Inner Join)|Join 조건에서 동일한 값이 있는 행만 반환하는 조인 기법|
|외부 조인(Outer Join)|Join 조건에서 동일한 값이 없더라도 행을 반환하는 조인 기법|
|크로스 조인(Cross Join)|Join 조건 없이 모든 데이터의 조합을 표현하는 조인 기법|
|자연 조인(Natural Join)|서로 다른 테이블에서 동일한 이름을 갖는 컬럼에 대해 자동으로 동등 조인 하는 기법|

|조건절|설명|
|:-:|-|
|ON 조건절|동일하지 않은 이름을 갖는 컬럼에 대해서도 Join 조건을 사용할 수 있는 기법|
|USING 조건절|동일한 이름을 갖는 컬럼 중에서 원하는 컬럼만 선택적으로 Join하는 기법|

### 3)내부 조인(Inner Join)
>Join조건에서 동일한 값이 있는 행만 반환하는 Join기법
```SQL
SELECT 컬럼명
    FROM 테이블1 INNER [JOIN] 테이블2 -- 테이블1과 테이블2를 INNER JOIN, INNER키워드 생략 가능
        ON 조건절;                  -- ON 조건절을 이용해 JOIN조건을 정의
```
### 4)외부 조인(Outer Join)
>Join조건에서 동일한 값이 없더라도 행을 반환하는 Join기법

|유형|설명|
|:-:|-|
|Left Outer Join|왼쪽 테이블을 기준으로 Outer Join수행|
|Right Outer Join|오른쪽 테이블을 기준으로 Outer Join수행|
|Full Outer Join|왼쪽, 오른쪽 모두 조건이 일치하지 않더라도 결합|
#### Liet Outer Join
>왼쪽 테이블을 기준으로 Outer Join을 수행하는 연산
```SQL
SELECT 컬럼명
    FROM 테이블1 LEFT OUTER JOIN 테이블2    -- 테이블1을 기준으로 LEFT OUTER 조인 수행
    ON 조건절;
```
#### Right Outer Join
>오른쪽 테이블을 기준으로 Outer Join을 수행하는 연산
```SQL
SELECT 컬럼명
    FROM 테이블1 RIGHT OUTER JOIN 테이블2   -- 테이블2를 기준으로 RIGHT OUTER 조인 수행
    ON 조건절;
```
#### Full Outer Join
>왼쪽, 오른쪽 모두 조건이 일치하지 않아도 결합하는 연산
```SQL
SELECT 컬럼명
    FROM 테이블1 FULL OUTER JOIN 테이블2
    ON 조건절;
```
### 5)Cross Join
>Join조건 없이 모든 데이터의 조합을 표현하는 Join 기법, Cartesian Product를 만들기위한 Join기법
```SQL
SELECT 컬럼명
    FROM 테이블1 CROSS JOIN 테이블2;
```
### 6)자연 조인(Natural Join)
>서로 다른 테이블에서 동일한 이름을 갖는 컬럼에 대해 자동으로 동등 조인(Equi Join; `=`)을 수행하는 Join기법
- 컬럼명과 데이터 유형이 동일해야하는 제약조건이 있다.
```SQL
SELECT 컬럼명
    FROM 테이블1 NATURAL JOIN 테이블2;
```
### 7)ON 조건절
> 동일하지 않은 이름을 갖는 컬럼에 대해서 원하는 컬럼만 선택적으로 Join하는 기법
- ON 조건절은 WHERE 조건절과 혼용해서 사용할 수 있다.
```SQL
SELECT 컬럼명
    FROM 테이블1 JOIN 테이블2
        ON 조건절;
```
### 8)USING 조건절
>동일한 이름을 갖는 컬럼 중 원하는 컬럼만 선택적으로 Join하는 기법
```SQL
SELECT 컬럼명
    FROM 테이블1 JOIN 테이블2
        USING 조건절;
```
## 집합 연산자
### 1)집합 연산자(Set Operator)의 개념
> 집합 연산자는 두 개 이상의 테이블을 연결하여 하나로 결합하는 연산자이다.
- 집합 연산자를 사용하기위해서는 SELECT 절의 컬럼 수와 데이터 타입이 동일해야한다.
### 2)집합 연산자의 유형

|유형|설명|
|:-:|-|
|`UNION`|합집합 연산을 수행, 중복된 행은 하나의 행으로 표시하는 연산자|
|`UNION ALL`|합집합 연산을 수행, 중복된 행은 그대로 중복되게 표시하는 연산자|
|`INTERSECT`|교집합 연산을 수행, 중복된 행은 하나의 행으로 표시하는 연산자|
|`MINUS`/`EXCEPT`|차집합 연산을 수행하며, 중복된 행은 하나의 행으로 표시하는 연산자|
#### UNION
>합집합 연산을 수행, 중복된 행은 하나의 행으로 표시하는 연산자
- 내부적으로 중복된 값을 제거하는 과정에서 정렬기능이 동작하게됨
#### UNION ALL
>합집합 연산을 수행, 중복된 행은 그대로 중복되게 표시하는 연산자
- UNION연산과 다르게 중복 제거 및 정렬이 없기에 성능상 유리
- ALIAS는 첫 번째 SQL을 기준으로 사용되며 ORDER BY는 마지막 SQL문에 사용가능
#### INTERSECT
>교집합 연산을 수행, 중복된 행은 하나의 행으로 표시하는 연산자
#### MINUS / EXCEPT
>차집합 연산을 수행하며, 중복된 행은 하나의 행으로 표시하는 연산자
- `NOT EXISTS`혹은 `NOT IN`서브쿼리를 이용한 SQL문으로도 변경 가능하다.
## 계층형 질의
### 1)계층형 질의의 개념
>계층형 질의는 동일 테이블에 상위와 하위의 포함관계를 가진 계층형 데이터를 계층형 구조로 조회하기 위한 질의.
### 2)계층형 질의 문법
#### 계층형 질의 문법
>ORACLE의 계층형 질의문에서 WHERE절은 모든 전개를 진행한 이후 필터조건으로서 조건을 만족을 하는 데이터만을 추출하는데 활용.
```SQL
SELECT 컬럼명
    FROM 테이블명
WHERE 조건
    START WITH 조건
CONNECT BY [NOCYCLE]
    조건 [ORDER SIBLINGS BY 컬럼명];
```
#### 계층형 질의 가상 컬럼
|가상컬럼|설명|
|:-:|-|
|LEVEL|루트 데이터는 1, 하위 데이터는 리프 데이터 까지 1씩 증가|
|`CONNECT_BY_ISLEAF`|해당 데이터가 리프 데이터면 1, 리프데이터가 아니면 0|
|`CONNECT_BY_ISCYCLE`|CYCLE이 존재하면 1, 그렇지 않으면 0|
#### 계층향 질의 함수
|함수|설명|
|:-:|-|
|`SYS_CONNECT_BY_PATH`|루트 데이터부터 현재 데이터까지의 경로를 표시|
|`CONNECT_BY_ROOT`|현재 데이터의 루트 데이터를 표시|
### 3)계층형 질의 유형
|유형|설명|
|:-:|-|
|순방향 계층형 질의|계층형 데이터를 상위에서 하위로 전개하는 질의|
|역방향 계층형 질의|계층형 데이터를 하위에서 상위로 전개하는 질의|
#### 순방향 계층형 질의
#### 역방향 계층형 질의
### 4)셀프 조인(Self Join)
>셀프 조인은 통일한 테이블 내에서 컬럼 사이에 연관 관계가 있을 때 사용하는 조인
- 테이블과 컬럼이름이 동일하기 때문에 별칭을 사용해 식별해야한다.
## 서브 쿼리
## 그룹 함수
## 윈도우 함수
## DCL
## 절차형 SQL