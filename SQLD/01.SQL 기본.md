# SQL 기본 및 활용
# SQL 기본
## 정보 요구사항
### 1)정보 요구사항의 개념
- 정보 요구사항은 특정한 목적의 정보시스템 개발을 위해 업무의 개선 사항이나 신규 개발 사항을 요청하는 내용이다.
- 정보 요구사항은 현행 시스템 분석, 사용자 요구사항 수집, 제안 요청사, 사업 수행 계획서 등을 이용해 수집 가능하다.
### 2) 정보 요구사항 생명주기 모형
- 정보 요구사항의 생명주기는 정보 요구사항 수집, 정보 요구사항 분석/정의, 정보 요구사항 상세화, 정보 요구사항 검증으로 이루어진다.
- 정보 요구사항 생명주기 모형을 반복적으로 수행하여 사용자의 정보 요구사항이 정보시스템에 누락 없이 반영되어야 한다.

|순서|단계|설명|
|-|:-:|-|
|1|정보 요구사항 수집|- 사용자의 정보 요구사항을 수집하는 단계<br>- 사용자 면답, 관련 문서, 설문, 워크샵, 현행 시스템 분석 등을 통해 수집|
|2|정보 요구사항 분석 및 정의|- 사용자로부터 수집된 정보 요구사항을 정리하는 단계<br>- 방법론에서 제시하는 다양한 기법을 이용해 분석 및 정의|
|3|정보 요구사항 상세화|- 정보 요구사항의 개별 사항을 상세히 분석 및 기록하는 단계<br>- 정보 요구사항의 개별 사항을 상세히 분석 및 기록하는 단계<br>- 정보 요구사항이 시스템에 정확히 반영될 수 있도록 상세히 작성|
|4|정보 요구사항 검증|- 사용자의 정보 요구사항을 비즈니스 관점, 조직 관점, 애플리케이션 관점과 상관분석을 통해 누락 없이 반영되었는지 검증하는 단계|
### 3)정보 요구사항 유형
|유형|설명|
|:-:|-|
|외부 인터페이스 요건|- 시스템의 모든 입력과 출력에 관한 요건|
|기능 개선 요건|- 시스템에서 입력을 받아 처리하고 출력을 만들어 내는 주요 활동이나 프로세스에 대한 요건|
|성능 개선 요건|- 사용자가 원하는 성능 개선 사<br>- 동시 사용자 수, 처리하는 정보의 양과 종류, 트랜잭션 소요 시한 등의 요건|
|보안 개선 요건|- 중요 데이터에 대한 훼손, 변조, 도난, 유출에 대한 물리적 접근 통제(제한 구역, 통제 구역등)및 사용 통제(인증, 암호화, 방화벽 등)에 대한 요건|
## 관계형 데이터베이스 개요
### 1)데이터베이스
- 데이터베이스는 여러 사람이 공유하고 사용할 목적으로 컴퓨터 시스템에 전자적 방식으로 저장된 구조화된 정보 또는 데이터의 체계적인 집합이다.
- 자료를 구조화하여 중복된 데이터를 없애고 효율적인 처리를 할 수 있도록 관리된다.
- 데이터베이스를 관리 및 제어하고, 다수의 사용자가 데이터베이스 내에 데이터에 접근하여 이용할 수 있도록 해주는 소프트웨어를 데이터베이스관리시스템(DBMS)라고 한다.
### 2)데이터베이스 유형
|유형|설명|
|-|-|
|계층형|- 데이터 간의 관계가 트리 형태로 구성되어 있는 모델<br>- 계층 간 일대다(1:N)형태로 구성 가능<br>- 데이터를 세그먼트(레코드) 단위로 관리하고 세그먼트 간의 계층을 트리 구조로 관리|
|네트워크형|- 계층형 데이터베이스의 단점을 보완하여 데이터 간에 다대다(N:N)구성이 가능한 망형 모델|
|관계형|- 키와 값으로 이루어진 데이터들을 행과 열로 구성된 테이블 구조로 저장 및 관리하는 데이터베이스 모델<br>- SQL을 사용하여 데이터를 처리|
|객체 지향형|- 객체 지향 프로그래밍 개념에 기반하여 만들어진 데이터베이스 모델이며 정보를 객체의 형태로 표현|
|객체 관계형|- 관계형 데이터베이스에 객체 지향 개념을 도입한 데이터베이스 모델<br>- 객체 지향 개념을 지원하는 표준 SQL 사용가능|
|NoSQL|- 정형 데이터뿐만이 아니라 영상이나 이미지와 같은 비정형 데이터도 관리하기 위한 데이터베이스 모델|
|NewSQL|- 관계형 데이터베이스와 NoSQL의 장점을 결합한 데이터베이스 모델|
### 3)관계형 데이터베이스
#### 관계형 데이터베이스 개념
- 관계형 데이터베이스는 키와 값들의 관계를 직관적이고 간단하게 표현하는 방법인 관계형 모델을 기반으로 서로 관련된 데이터를 저장 및 관리하는 데이터베이스 유형이다.
- 1970년 E.F.Codd박사에 의해 제안됨

>관계형 데이터베이스의 특징

|특징|설명|
|:-:|-|
|정규화|정규화를 통해 이상현상(Anomaly)을 제거하고 중복을 배제|
|데이터 표준화|데이터 품질 확보|
|무결성 보장|다양한 제약조건을 통해 조건에 위배되는 데이터 입력이나 중요 데이터 삭제를 방지|
|회복성|시스템 다운, 재해/재난 등의 상황에서도 데이터를 회복/복구할 수 있는 기능 제공|
|동시 사용|동시성 관리, 병행 제어를 통해 많은 사용자들이 동시에 데이터를 조작 가능|
|보안 기능 제공|DBMS에 의해 인증된 사용자만이 참조할 수 있도록 보안 기능 제공|
#### 관계형 데이터베이스 주요 용어
|용어|설명|
|:-:|-|
|테이블|- 같은 속성을 공유하는 행(Row)들의 모임<br>- 행과 컬럼의 2차원 구조를 가진 데이터 저장소|
|열(Column)|- 테이블의 세로 방향<br>- 각각의 열은 유일한 이름을 가지고 있고, 자신만의 데이터 타입을 가짐<br>- 속성(Attribute)|
|행(Row)|- 테이블에서 가로 방향<br>- 관계된 데이터의 묶음<br>- 튜플(Tuple) 또는 레코드(Record)|
|값(Value)|- 각각의 행과 열에 대응하는 값|
|키(Key)|- 테이블에서 행의 식별자로 이용되는 열<br>- 기본키(Primary Key)|
|관계(Relationship)|- 테이블 간의 관계<br>- 일대일(One-to-One), 일대다(One-to-Many), 다대다(Many-to-Many)|
### 4)SQL(Structured Query Language)
SQL은 관계형 데이터베이스에서 데이터의 정의(Definition), 데이터 조작(Manipulation), 데이터 제어(Control)등을 위해 사용하는 언어이다.
|SQL 종류|명령어|설명|
|:-:|:-:|-|
|데이터 정의어<br>(DDL : Data Definition Language)|CREATE<BR>ALTER<BR>RENAME<BR>DROP<BR>TRUNCATE|테이블이나 인덱스 같은 데이터 구조를 정의하거나 수정, 삭제하는데 사용되는 명령어|
|데이터 조작어<br>(DML : Data Manipulation Language)|SELECT<BR>INSERT<BR>UPDATE<BR>DELETE|데이터베이스에 들어 있는 데이터를 조회하거나 변경하기 위한 명령어|
|데이터 제어어<br>(DCL : Data Control Language)|GRANT<BR>REVOKE|데이터베이스에 접근하거나 객체들을 사용할 수 있는 권한을 제어하기 위한 명령어|
|트랜잭션 제어어<br>(TCL : Transaction Control Language)|COMMIT<BR>ROLLBACK<BR>SAVEPOINT|트랜잭션을 제어하기 위한 명령어|
### 5)TABLE
- 테이블은 데이터를 저장하는 객체(Object)로서 관계형 데이터베이스의 기본 단위이다.
>테이블의 구조
>|-----|-----|열(Column)<br>속성(Attribute)|-----|
>|:-:|:-:|:-:|:-:|
>|-----|-----|-----|-----|
>|행(Row)<br>튜플(Tuple)<br>레코드(Record)|-----|-----|-----|
>|-----|-----|-----|-----|

## DDL
### 1)DDL의 개념 및 대상
#### DDL(Data Definition Language)의 개념
DDL은 데이터베이스의 테이블과 같은 데이터 구조나 구성 요소를 생성, 삭제, 변경하는 언어이다.
#### DDL의 대상
|DDL의 대상|설명|
|:-:|-|
|테이블(Table)|- 데이터를 저장하는 기본 저장 단위<br>- 행과 열로 구성|
|뷰(View)|- 하나 이상의 물리 테이블에서 유도되는 가상의 테이블|
|인덱스(Index)|- 검색 속도를 향상시키기 위한 데이터베이스 오브젝트|
|스키마(Schema)|- 데이터베이스의 구조와 제약조건에 관한 전반적인 명세를 기술한 메타데이터 집합|
#### 데이터 유형
- 컬럼을 정의할 때 선언한 데이터 유형은 해당 컬럼이 받아들일 수 있는 자료의 유형을 규정한다.
- 선언한 데이터 유형이 아닌 다른 유형의 데이터가 입력되거나 지정한 데이터의 크기를 넘어서는 자료가 입력되면 에러가 발생한다.

|유형|설명|
|:-:|-|
|CHARACTER(size)|길이가 size byte인 고정 길이 문자 데이터|
|VARCHAR(size)|최대 길이가 size인 가변길이 문자 데이터|
|NUMERIC|정수, 실수 등의 숫자 데이터|
|DATETIME|날짜와 시각 데이터|

### 2)DDL의 명령어

유형에 따라 생성, 수정, 삭제로 나뉜다.
|유형|명령어|설명|
|:-:|:-:|:-:|
|생성|CREATE|새로운 데이터베이스 개체 생성|
|수정|ALTER|이미 존재하는 데이터베이스 개체에 대한 변경|
||RENAME|개체의 이름을 변경|
|삭제|DROP|이미 존재하는 데이터베이스 개체 삭제|
||TRUNCATE|데이터베이스 개체에서 내용 삭제|
#### CREATE 명령어
`CREATE`명령어는 데이터베이스, 테이블 인덱스등을 생성하는 명령어이다.
>테이블 생성을 위한 CREATE TABLE 문법.
```SQL
CREATE TABLE 테이블명(
    컬럼명 데이터 유형 [NOT NULL],
    [컬럼명 데이터 유형 [NOT NULL], ...]
    CONSTRAINT 기본키명 PRIMARY KEY(컬럼명),
    CONSTRAINT 고유키명 UNIQUE(컬럼명[, 컬럼명,
    ...]),
    CONSTRAINT 외래키명 FOREIGN KEY(컬럼명) REFERENCES 참조테이블(참조테이블_기본키),
    CONSTRAINT 제약조건명 CHECK(조건식)
);
```
>테이블 생성시 주의사항

|주의사항|설명|
|:-:|-|
|적절한 이름|- 테이블의 이름은 객체를 의미할 수 있는 적절한 이름을 사용<br>- 가능한 단수형 사용|
|테이블 이름 중복|- 다른 테이블과 이름이 중복되지 않도록 함|
|컬럼 이름 중복|- 한 테이블 안에서는 컬럼 이름이 중복될 수 없음|
|데이터 유형|- 컬럼 뒤에 데이터 유형을 반드시 지정|
|문자로 시작|- 테이블 이름과 컬럼 이름은 반드시 문자로 시작<br>- 데이터베이스 공급업체(벤더)별로 이름 길이에 대한 제한 잇음<br>- A-Z, a-z, 0-9, _, $, # 문자만 허용|
|예약어|벤더에서 사전에 정의한 예약어는 사용 불가|


제약조건은 사용자가 원하는 조건의 데이터만 유지하기 위한 방법<br>
제약조건은 테이블의 특정 컬럼에 설정하는 제약이다.
>제약조건의 종류

|종류|설명|
|:-:|-|
|PRIMARY KEY<br>(기본키)||
|UNIQUE KEY<br>(고유키)||
|NOT NULL||
|CHECK||
|FOREIGN KEY<br>(외래키)||
|DEFAULT||

무결성은 데이터베이스에 저장된 값들이 정확하고 일관성 있는 데이터임을 나타내는 특성이다.<br>
무결성의 종류에는 개체 무결성, 참조 무결성 등이 있다.
>무결성의 종류

|종류|설명|DBMS 제약조건|
|-|-|-|
|개체 무결성|- 기본키 제약이라고도 하며, 하나의 테이블에 중복된 행이 존재하지 않도록 규정|UNIQUE, PRIMARY KEY|
|참조 무결성|- 행을 입력, 수정, 삭제할 때 연관되는 다른 테이블과의 데이터가 정확하게 유지되도록 규정<br>- 참조 관계에 있는 두 테이블의 데이터가 항상 일관된 값을 가져야함|FOREIGN KEY|


관계 테이블의 모든 외부 식별자 값은 관련 있는 관계 테이블의 모든 주 식별자 값이 존재해야 한다.
>참조 무결성 규칙 정의

자식테이블에 인스턴스 입력시 참조 무결성 규칙
>|규칙|설명|
>|-|-|
>|DEPENDENT|대응되는 부모 테이블에 인스턴스가 존재할 때만 자식 테이블에 입력 허용|
>|AUTOMATIC|자식 테이블의 인스턴스 입력을 항상 허용하고, 대응되는 부모 테이블에 인스턴스가 없는 경우 이를 자동으로 생성|
>|SET NULL|자식 테이블에 인스턴스의 입력을 항상 허용하고ㅡ 대응되는 부모 테이블에 인스턴스가 없는 경우 자식 테이블의 FK(외래키)를 NULL 값으로 입력|
>|SER DEFAULT|자식 테이블에 인스턴스의 입력을 항상 허용하고, 대응되는 부모 테이블에 인스턴스가 없는 경우 FK(외래키)를 지정된 기본값으로 입력|

부모 테이블의 인스턴스 삭제(또는 수정)시 참조 무결성 규칙
>|규칙|설명|
>|-|-|
>|RESTRICT|대응되는 자식 테이블의 인스턴스가 없는 경우에만 부모 테이블의 인스턴스 삭제를 허용|
>|CASCADE|부모 테이블의 인스턴스 삭제를 항상 허용하고, 대응되는 자식 테이블의 인스턴스를 자동 삭제|
>|SET NULL|부모 테이블의 인스턴스 삭제를 항상 허용하고 대응되는 자식 테이블의 인스턴스가 존재하면 FK(외래키)를 NULL값으로 수정|
>|SET DEFAULT|부모 테이블의 인스턴스 삭제를 항상 허용하고, 대응되는 자식 테이블의 인스턴스가 존재하면 FK(외래키)를 기본값으로 수정|

#### ALTER 명령어
`ALTER`명령어는 컬럼이나 제약조건을 추가/삭제하기위한 명령어이다.
|구분|문법|설명|
|:-:|-|-|
|컬럼 추가<br>(ADD)|`ALTER TABLE 테이블명 ADD 컬럼명 데이터 유형 [기본값][NOT NULL];`|테이블에 컬럼 추가|
|컬럼 수정<br>(MODIFY)|`ALTER TABLE 테이블명 MODIFY 컬럼명 데이터유형[기본값][NOT NULL];`|컬럼의 데이터 유형, 기본값, NOT NULL등의 제약조건에 대한 변경|
|컬럼 삭제<br>(DROP COLUMN)|`ALTER TABLE 테이블명 DROP COLUMN 삭제할컬럼명;`|컬럼을 삭제|
|컬럼명 수정<br>(RENAME COLUMN)|`ALTER TABLE 테이블명 RENAME COLUMN 기존컬럼명 TO 새로운컬럼명;`|컬럼명을 변경|
|제약조건 삭제<br>(DROP CONSTRAINT)|`ALTER TABLE 테이블명 DROP CONSTRAINT 제약조건명;`|기존 제약조건을 삭제|
|제약조건 추가<br>(ADD CONSTRAINT)|`ALTER TABLE 테이블명 ADD CONSTRAINT 제약조건명 제약조건 (컬럼명);`|테이블에 제약조건을 추가|
#### RENAME 명령어
`RENAME TABLE`은 테이블의 이름을 변경하는 명령어이다.
```SQL
RENAME 변경전테이블명 TO 변경후테이블명;
-- 테이블 이름을 변경
```
#### DROP TABLE 명령어
`DROP` 명령은 불필요한 테이블을 삭제하기 위한 명령어이다.
```SQL
DROP TABLE 테이블명 [CASCADE CONSTRAINT];
-- 테이블 모든 데이터와 구조까지 완전 삭제
```
#### TRUNCATE TABLE 명령어
`TRUNCATE` 명령은 테이블에 저장된 모든 행을 제거하고 저장 공간을 재사용할 수 있도록 해제하는 명령어이다.
```SQL
TRUNCATE TABLE 테이블명;
-- 테이블의 모든 행을 삭제
-- 최초 생성된 초기 상태로 만듬
```

#### DROP, TRUNCATE, DELETE비교
`DROP`, `TRUNCATE`, `DELETE`는 테이블/데이터를 삭제하는 명령어로 비교하면 다음과 같다.
|구분|DROP|TRUNCATE|DELETE|
|:-:|:-|:-|:-|
|명령어 종류|DDL|DDL|DML|
|Rollback|불가능|불가능|Commit 이전이면 Rollback가능|
|Commit|Auto Commit|Auto Commit|사용자 Commit|
|Release|테이블이 사용했던 Storage를 모두 Release|테이블이 사용했던 Storage중 최초 테이블 생성시 할당된 Storage만 남기고 Release|사용헀던 Storage는 Release되지 않음|
|삭제 상태|테이블 정의까지 완전히 삭제|최초 생성된 초기 상태로 만듦|데이터만 삭제|
|삭제 로그|로그 기록 없음|로그 기록 없음|로그 기록 있음|
## DML
### 1)DML(Data Manipulation Language)의 개념
- DML은 데이터베이스에 저장된 데이터를 조회, 입력, 수정, 삭제하는데 사용하는 질의어이다.
- DML은 비절차적 데이터 조작어이며, 사용자가 무슨(What)데이터를 원하는지만을 명세한다.
- C언어와 같은 호스트 프로그램 속에 삽입되어 사용되는 DML은 데이터 부속어(Data Sub Language)라고 한다.
### 2)DML의 유형
|유형|동작|설명|
|:-:|:-:|-|
|SELECT|데이터 조회|테이블을 구성하는 레코드 중에서 전체 또는 조건을 만족하는 레코드를 조회하는 명령어|
|INSERT|데이터 입력|테이블에 새로운 레코드를 입력할 때 사용하는 명령어|
|UPDATE|데이터 수정|테이블에 있는 레코드 중에서 특정 레코드의 내용을 변경할 때 사용하는 명령어|
|DELETE|데이터 삭제|테이블에 있는 레코드 중에서 특정 레코드를 삭제할 때 사용하는 명령어|
### 3)DML의 명령어
#### SELECT 명령어
`SELECT`명령어는 데이터의 내용을 조회할 때 사용하는 명령어이다.
```SQL
SELECT [ALL|DISTINCT] 컬럼명 AS 별명
FROM 테이블명;
-- SELECT절에서 WILDCARD및 ESCAPE 사용 가능
-- SELECT절에서 명시한 컬럼을 FROM절의 테이블에서 조회
-- ALL/DISTINCT : 생략가능, 생략시 ALL
-- DISTINCT : 중복된 데이터가 있는 경우 중복을 제거하여 1건만 조회하는 기능
-- AS : 생략가능
-- AS 키워드를 사용해 컬럼의 별명(ALIAS) 변경 가능
```
#### INSERT 명령어
`INSERT`명령어는 데이터의 내용을 입력할 때 사용하는 명령어이다.
```SQL
INSERT INTO 테이블명(컬럼명)
VALUES (입력값, ...);
-- 데이터를 입력하고자 하는 테이블의 컬럼을 정의하여 데이터를 입력
-- 컬럼과 입력값은 1:1로 매핑되며, 정의하지 않은 컬럼은 디폴트로 NULL
INSERT INTO 테이블명
VALUES 입력값;
-- 컬럼을 생략하는 경우 모든 컬럼을 대상으로 데이터 입력
-- 입력값은 테이블의 컬럼 수와 같아야 함
```
#### UPDATE 명령어
`UPDATE`명령어는 데이터의 내용을 수정할 때 사용하는 명령어이다.
```SQL
UPDATE 테이블명
    SET 컬럼명 = 입력값
WHERE 조건;
```
#### DELETE 명령어
`DELETE`명령어는 데이터의 내용을 삭제할 때 사용하는 명령어이다.
```SQL
DELETE [FROM] 테이블명
WHERE 조건;
```
### 4)산술 연산자와 합성 연산자
산술 연산자는 수학 계산을 위한 연산자, 합성 연산자는 문자와 문자를 연결하는 연산자
>`NULL`을 포함한 연산에 대해 산술연한은 결과가 `NULL`이고, 합성 연산은 `NULL`을 제외하고 연산한다.

|구분|연산자|설명|
|:-:|:-:|:-:|
||(&nbsp;&nbsp;&nbsp;&nbsp;)|괄호 안의 연산 우선순위를 높임|
||*|곱하기 연산을 수행|
|산술 연산자|/|나누기 연산을 수행|
||+|더하기 연산을 수행|
||-|빼기 연산을 수행|
|합성 연산자|\|\||문자와 문자를 연결|

## TCL
### 1)TCL(Transaction Control Language)의 개념
TCL은 트랜잭션을 제어하는 명령어이다.
#### TCL의 명령어
|명령어|설명|
|:-:|:-:|
|COMMIT|올바르게 수행된 트랜잭션의 결과를 데이터베이스에 반영하는 명령어|
|ROLLBACK|문제 발생 시 하나의 트랜잭션을 취소하는 명령어|
|SAVEPOINT|하나의 트랜잭션을 작게 분할하여 저장하는 기능을 수행하는 명령어|
#### 트랜잭션(TRANSACTION)
>트랜잭션은 업무 처리를 위한 데이터베이스의 논리적인 작업단위.
- 하나의 트랜잭션은 한 개 이상의 연산으로 이루어질 수 있고, 이 연산들은 완전히 처리되거나 아예 한 개도 처리되지 않아야 한다.(`All or Nothing`)

>트랜잭션의 특성
>|특성|설명|
>|:-:|:-|
>|원자성<br>(Atomicity)|- 트랜잭션은 더 이상 분해가 불가능한 업무의 최소 단위<br>- 트랜잭션에서 정의된 연산들은 모두 성공적으로 실행되거나 전혀 실행되지 않아야 함(All or Nothing)|
>|일관성<br>(Consistency)|- 트랜잭션이 실행되기 전과 후의 데이터베이스 내용에 잘못이 있으면 안됨<br>- 트랜잭션 실행의 결과로 데이터베이스의 상태가 모순되지 않아야 함|
>|격리성<br>(Isolation)|- 실행 중인 트랜잭션의 중간 결과에 다른 트랜잭션의 접근 불가|
>|영속성<br>(Durability)|- 트랜잭션이 성공적으로 수행되면, 그 트랜잭션이 갱신한 데이터베이스의 내용은 영구적으로 저장|

>트랜잭션의 격리성(Isolation) 수준
>|격리성 수준|설명|
>|:-:|:-:|
>|Read Uncommitted|트랜잭션에서 처리 중인 아직 커밋되지 않은 데이터를 다른 트랜잭션이 읽는 것을 허용|
>|Read Committed|트랜잭션이 커밋되어 확정된 데이터만 다른 트랜잭션이 읽을 수 있도록 허용|
>|Repeatable Read|트랜잭션이 완료되기 전까지 Shared-Lock을 적용하여 다른 트랜잭션에서 해당 데이터를 수정할 수 없도록 함|
>|Serializable Read|Shared-Lock이 범위(Range) 단위로 적용되고, 트랜잭션이 완료된 이후에 해제|

>트랜잭션 격리성 수준에 따라 발생할 수 있는 현상
>|현상|설명|
>|:-:|:-:|
>|Dirty Read|데이터 캐시에는 변경이 되었지만 디스크에는 변경되기 전에 데이터를 읽어 일관성을 잃는 현상|
>|Non-Repeatable Read|트랜잭션 내 다른 시점에 읽은 하나의 데이터가 값이 다른 현상|
>|Phantom Read|- 트랜잭션 수행 중에는 없던 행이 추가되어 새로운 데이터를 읽게 되거나 존재하던 데이터가 사라지는 현상<br>- 트랜잭션 내 동일한 조건으로 읽은 데이터의 개수가 달라지는 현상|
>
>|격리성 수준\발생할 수 있는 현상|Dirty Read|Non-Repeatable|Phantom Read|
>|:-:|:-:|:-:|:-:|
>|Read Uncommitted|가능|가능|가능|
>|Read Committed|불가능|가능|가능|
>|Repeatable Read|불가능|불가능|가능|
>|Serializable Read|불가능|불가능|불가능|

### 2)COMMIT
#### COMMIT의 개념
`COMMIT`은 하나의 트랜잭션을 정상적으로 완료하고 그 결과를 데이터베이스에 반영하는 명령어이다.
#### SQL SERVER의 트랜잭션 방식
|방식|설명|
|:-:|:-:|
|AUTO COMMIT|성공적으로 수행되면 자동으로 COMMIT을 수행하고 오류가 발생하면 자동으로 ROLLBACK 수행|
|암시적 트랜잭션|트랜잭션의 시작은 DBMS가 처리하고 트랜잭션의 끝은 사용자가 명시적으로 COMMIT이나 ROLLBACK처리|
|명시적 트랜잭션|사용자가 트랜잭션의 시작과 끝을 지정하는 방식으로<br> `BEGIN TRANSACTION`으로 트랜잭션을 시작하고<br> `COMMIT/ROLLBACK [TRANSACTION]`으로 트랜잭션을 종료|
### 3)ROLLBACK
`ROLLBACK`은 문제가 발생한 트랜잭션을 취소하기 위한 명령어
- 데이터베이스의 비정상적인 종료는 자동으로 ROLLBACK된다.
### 4)SAVEPOINT
`SAVEPOINT`는 하나의 트랜잭션을 작게 분할하여 저장하는 명령어이다.
- 하나의 트랜잭션에 여러 개의 SAVEPOINT 지정이 가능하다.
```SQL
SAVEPOINT 저장지점명
-- SAVEPOINT 생성
ROLLBACK TO 저장지점명
-- 특정 SAVEPOINT까지 ROLLBACK
```
## WHERE 절
### 1)WHERE절 개념
`WHERE`절은 사용자가 원하는 자료만을 검색하여 출력하기 위해 SQL문장에 추가하여 사용하는 조건절.
### 2)WHERE절 문법
`WHERE`절은 `FROM`절 다음에 위치한다.
```SQL
SELECT [DISTINCT|ALL] 컬럼명
FROM 테이블명
WHERE 조건식;
```
### 3)연산자의 종류
|종류|설명|
|:-:|-|
|비교 연산자|연산자를 기준으로 왼쪽의 값과 오른쪽의 값의 크기를 비교하기 위한 연산자|
|SQL 연산자|기본적으로 예약된 연산자|
|논리 연산자|여러 조건을 논리적으로 연결하기 위해 사용되는 연산자|
|부정 연산자|- 비교 연산자나 SQL 연산자에 대한 부정을 표현하기 위한 연산자<br>- 부정 비교 연산자와 부정 SQL 연산자가 있음|
#### 연산자 우선순위
|우선순위|설명|
|:-:|-|
|1|`( )`안에 있는 연산이 가장 먼저 수행|
|2|NOT 연산자|
|3|비교 연산자, SQL 비교 연산자|
|4|AND 연산자|
|5|OR 연산자|
#### 비교 연산자
>연산자 기준 왼쪽과 오른쪽의 값 크기를 비교하는 연산자

|연산자|설명|
|:-:|-|
|=|같음|
|>|큼|
|>=|보다 크거나 같음|
|<|보다 작음|
|<=|보다 작거나 같음|
#### SQL 연산자
>예약된 연산자로 모든 데이터 타입에 대해 연산이 가능하다.

|연산자|설명|
|:-:|-|
|BETWEEN a AND b|a와 b의 값 사이의 값을 가짐(a, b를 포함)|
|IN (list)|list에 있는 값 중에서 어느 하나라도 일치 해야함|
|LIKE '비교문자열'|비교 문자열과 형태가 일치해야함 (%, _사용)|
|IS NULL|NULL값을 가짐|

>와일드카드 종류

|와일드카드|설명|
|:-:|-|
|%|0개 이상의 문자|
|_|1개의 문자|
|+|문자열을 연결|
|[]|1개의 문자와 일치<br>ex) LIKE 'A[bc]d';는 Abd, Acd와 매칭|
|[^]|1개의 문자와 불일치<br>ex) LIKE 'A[^bc]d';는 A로 시작하고 d로 끝나는 문자열중 가운데 글자가 b혹은 c가 아닌 문자열과 매칭|
#### 논리 연산자
>여러 조건을 논리적으로 연결하기 위해 사용되는 연산자.

|연산자|설명|
|:-:|-|
|AND|AND 앞,뒤의 조건을 모두 만족해야함|
|OR|OR 앞이나 뒤의 조건 중 하나를 만죽해야함|
|NOT|NOT 뒤의 조건에 반대되는 결과|
#### 부정 연산자
>부정 연산자는 비교 연산자나 SQL 연산자에 부정을 표현하기 위한 연산자.

|구분|연산자|설명|
|-|-|-|
|부정 비교 연산자|`!=`, `^=`, `< >`, `NOT 컬럼명 =`, `NOT 컬럼명 >`|같지않음, 크지않음|
|부정 SQL 연산자|`NOT BETWEEN a AND b`, `NOT IN (list)`, `IS NOT NULL`|a와 b의 값 사이에 있지 않음(a, b 미포함), list에 있는 값과 일치하지 않음, NULL값이 아님|
### 4)Top N 쿼리
>테이블 상위에서 N개의 데이터를 출력하는 유형의 질의문을 `Top N`쿼리라고 한다.
#### ORACLE의 ROWNUM
`ROWNUM`은 질의에서 반환되는 결과 레코드 수를 제한한다.
```SQL
SELECT EMP_NAME, SALARY
    FROM EMP
WHERE ROWNUM <= 3 -- 1. EMP 테이블에서 상위 3건을 먼저 추출하고 
    ORDER BY SALARY ASC; -- 2. 오름차순 정렬 수행
```

```SQL
SELECT EMP_NAME, SALARY
    FROM (
        SELECT EMP_NAME, SALARY
            FROM EMP
        ORDER BY SALARY ASC; -- 1. 인라인 뷰를 통해 EMP테이블에서 데이터를 먼저 오름차순 정렬
    )
WHERE ROWNUM <= 3 -- 2. 이후 상위 3건을 추출
```

위 두 쿼리는 `SELECT`문장 실행 순서에 따른 다른 결과가 나타나게 된다.<br>`SELECT`문장의 실행 순서
1. FROM절
2. WHERE절
3. GROUP BY절
4. HAVING절
5. SELECT절
6. ORDER BY절

## FUNCTION
### 1)FUNCTION(함수)의 개념
>`FUNCTION`은 데이터베이스에서 입력값을 처리하고 결괏값을 반환하는 프로그램
- 크게 내장 함수와 사용자 정의 함수로 구분할 수 있으며 내장함수는 단일 행 함수와 다중 행 함수로 나눌 수 있다.

#### 내장 함수
단일 행 함수
- 단일 행 값을 입력해 단일 값을 반환하는 함수
- 문자형/숫자형/날짜형/형 변환/NULL 관련 함수가 있다.
- SELECT/WHERE/ORDER BY/UPDATE 의 SET절에서 사용할 수 있다.
- 1:M관계의 두 테이블을 조인할 경우 M쪽에 단일 행 함수 사용가능.

다중 행 함수
- 다중 행 값을 입력해 단일 값을 반환하는 함수
- 집계 함수, 그룹 함수, 윈도우 함수
#### 사용자 정의 함수
- 사용자가 작성하는 함수
- 절차형 SQL
### 2)단일 행 함수의 유형
|유형|함수|
|:-:|-|
|문자형 함수|`LOWER`, `UPPER`, `SUBSTR`, `LENGTH`, `LTRIM`, `RTRIM`, `TRIM`, `ASCII`, `REPLACE`|
|숫자형 함수|`ABS`, `MOD`, `ROUND`, `TRUNC`, `SIGN`, `CHR`, `CEIL`, `FLOOR`, `EXP`, `LOG`, `LN`, `POWER`, `SIN`, `COS`, `TAN`|
|날짜형 함수|`SYSDATE`, `EXTRACT`|
|형 변환 함수|`TO_NUMBER`, `TO_CHAR`, `TO_DATE`|
|NULL관련 함수|`NVL`, `NULLIF`, `COALESCE`|

#### 문자형 함수
>`SELECT`, `WHERE`, `ORDER BY` 절에서 사용 가능

|함수|설명|
|:-:|-|
|`LOWER(문자열)`|문자열을 소문자로 변환|
|`UPPER(문자열)`|문자열을 대문자로 변환|
|`ASCII(문자)`|문자의 ASCII 값을 반환|
|`CHAR(ASCII코드)`|ASCII코드를 문자로 변환|
|`SUBSTR(문자열, 시작위치, 길이)`|문자열의 일부를 추출|
|`LENGTH(문자열)`|문자열의 길이를 반환|
|`LTRIM(문자열, 제거할문자)`|문자열의 왼쪽에서 지정된 문자를 제거|
|`RTRIM(문자열, 제거할문자)`|문자열의 오른쪽에서 지정된 문자를 제거|
|`TRIM(제거할문자 FROM 문자열)`|문자열의 양쪽에서 지정된 문자를 제거|
|`LPAD(문자열, 길이[, 채움문자]])`|지정된 길이로 문자열을 왼쪽으로 채우고, 필요한 경우 지정된 채움 문자를 사용합니다.|
|`RPAD(문자열, 길이[, 채움문자]])`|지정된 길이로 문자열을 오른쪽으로 채우고, 필요한 경우 지정된 채움 문자를 사용합니다.|
|`REPLACE(문자열, 기존문자, 새문자)`|문자열에서 기존 문자를 새 문자로 대체|

#### 숫자형 함수
|함수|설명|
|:-:|-|
|`ABS(숫자)`|숫자의 절대값을 반환|
|`SIGN(숫자)`|숫자의 부호를 반환 (-1, 0, 1)|
|`MOD(숫자1, 숫자2)`|숫자1을 숫자2로 나눈 나머지를 반환|
|`CEIL(숫자)`|숫자를 올림|
|`FLOOR(숫자)`|숫자를 내림|
|`ROUND(숫자, 소수점자리)`|숫자를 지정된 소수점 자리로 반올림|
|`TRUNC(숫자, 소수점자리)`|숫자를 지정된 소수점 자리로 버림|
|`EXP(숫자)`|숫자의 지수 값을 반환|
|`LOG(숫자)`|숫자의 로그 값을 반환|
|`LN(숫자)`|숫자의 자연 로그 값을 반환|
|`POWER(숫자, 지수)`|숫자의 지수 값을 반환|
|`SIN(숫자)`|숫자의 사인 값을 반환|
|`COS(숫자)`|숫자의 코사인 값을 반환|
|`TAN(숫자)`|숫자의 탄젠트 값을 반환|

#### 날짜형 함수
|함수|설명|
|:-:|-|
|`SYSDATE`|현재 날짜와 시간을 반환|
|`EXTRACT(필드 FROM 날짜)`|날짜에서 지정된 필드를 추출|
#### 형 변환 함수
|함수|설명|
|:-:|-|
|`TO_NUMBER(문자열)`|문자열을 숫자로 변환|
|`TO_CHAR(숫자 또는 날짜, 형식)`|숫자 또는 날짜를 문자열로 변환|
|`TO_DATE(문자열, 형식)`|문자열을 날짜로 변환|
#### NULL 관련 함수
|함수|설명|
|:-:|-|
|`NVL(표현식1, 표현식2)`|표현식1이 NULL이면 표현식2를 반환|
|`NULLIF(표현식1, 표현식2)`|표현식1과 표현식2가 같으면 NULL을 반환, 그렇지 않으면 표현식1을 반환|
|`COALESCE(표현식1, 표현식2, ...)`|NULL이 아닌 첫 번째 표현식을 반환|

###  3)CASE문
> 비교문(IF)를 구현하기위해 사용하는 문장<br>`SIMPLE_CASE_EXPRESSION`과 `SEARCHED_CASE_EXPRESSION`이 있다.

#### SIMPLE_CASE_EXPRESSION

CASE 다음에 조건식을 표현
```SQL
CASE 조건식 WHEN 값1 THEN 결과1
            WHEN 값2 THEN 결과2
            ...
            WHEN 값n THEN 결과n
END
```
#### SEARCHED_CASE_EXPRESSION
WHEN 다음에 조건식을 표현
```SQL
CASE 조건식 WHEN 조건식1 THEN 결과1
            WHEN 조건식2 THEN 결과2
            ...
            WHEN 조건식n THEN 결과n
END
```
## GROUP BY, HAVING 절
### 집계 함수
#### 집계 함수(Aggregate Function)의 개념
- 집계 함수는 특정 컬럼에 대한 행들의 값을 통계적으로 계산한 결과를 제공하는 함수
- 개수, 합, 평균, 최댓값, 최솟값의 계산 기능을 제공
- NULL값은 제외하고 계산
- `SELECT`절, `HAVING`절, `ORDER BY`절에 사용할 수 있다.
#### 집계 함수의 문법
```SQL
집계함수명([DISTINCT|ALL]컬럼명|표현식)
```
#### 집계함수의 종류
|집계 함수|설명|
|:-:|-|
|`COUNT(*)`|컬럼의 행의 수를 출력(NULL값을 포함)|
|`COUNT(컬럼 \| 표현식)`|컬럼이나 표현식에 해당하는 값이 있는 행의 수를 출력(NULL)|
|`SUM([DISTINCT \| ALL] 컬럼명 \| 표현식)`|컬럼이나 표현식에 해당하는 값의 합계 출력(NULL값 제외)|
|`AVG([DISTINCT \| ALL] 컬럼명 \| 표현식)`|컬럼이나 표현식에 해당하는 값들의 평균 출력(NULL값 제외)|
|`MAX([DISTINCT \| ALL] 컬럼명 \| 표현식)`|컬럼이나 표현식에 해당하는 값 중 최댓값 출력(문자, 날짜 데이터 타입도 가능)|
|`MIN([DISTINCT \| ALL] 컬럼명 \| 표현식)`|컬럼이나 표현식에 해당하는 값 중 최솟값 출력(문자, 날짜 데이터 타입도 가능)|
|`STDDEV([DISTINCT \| ALL] 컬럼명 \| 표현식)`|컬럼이나 표현식에 해당하는 값들의 표준편차 출력|
|`VARIANCE/VAR([DISTINCT \| ALL] 컬럼명 \| 표현식)`|표현식에 해당하는 값들의 분산을 출력|
|기타 통계 함수|벤뎌별 다양한 통계식 함수|
### GROUP BY 절
>`GROUP BY`절은 사용자가 지정한 컬럼의 값이 같은 행들을 모아 그룹을 만들고 그룹별 검색을 하기 위해 사용.

```SQL
SELECT [ALL|DISTINCT] 컬럼명 [AS 별칭명]
    FROM 테이블명
[WHERE 조건식]          -- 전체 데이터를 GROUP으로 나누기 전 행들을 미리 제거
[GROUP BY 컬럼명 | 표현식] -- GROUP BY 절을 통해 소그룹별 기준을 정해 GROUP으로 나눔
[HAVING 그룹조건식];    -- 나누어진 소그룹에 대해 조건 적용
```

### HAVING 절
>`HAVING`절은 그룹에 대한 조건을 작성하기 위해 사용.<br>집계 함수는 WHERE절에는 사용할 수 없지만 HAVING절에는 사용할 수 있다.
### 집계함수와 NULL
>전체 건수가 `NULL`인 경우만 결과가 `NULL`, 전체 건수중 일부만 `NULL`인 경우 `NULL`인 행은 집계 대상에서 제외
## ORDER BY 절
### 1)ORDER BY 절 개념
>`ORDER BY`특정 컬럼을 기준으로 데이터를 정렬하는 구문<br>`ORDER BY`절에는 컬럼명, `ALIAS`명, 컬럼 순서를 나타내는 정수 등 이를 복합적으로도 사용할 수 있다.
### 2)ORDER BY 특징
|특징|설명|
|:-:|-|
|구문 위치|SQL 문장의 제일 마지막 위치|
|기본값|별도로 정렬방식을 지정하지 않으면 오름차순(ASC)|
|숫자형 데이터|작은수 부터 큰 수로 정렬|
|날짜형 데이터|과거부터 현제 데이터를 출력|
|NULL|ORACLE : NULL이 가장 큰 값<br>SQL SERVER : NULL이 가장 작은 값|
### 3)ORDER BY 절 문법
```SQL
SELECT [ALL|DISTINCT] 컬럼명 [AS 별칭명]
    FROM 테이블명
[WHERE 조건식]
[GROUP BY 컬럼명 | 표현식]
[HAVING 그룹조건식]
[ORDER BY 컬럼명 | 표현식 [ASC |DESC]];
```
### 4)ORDER BY CASE 문법
특정 조건을 기준으로 정렬이 필요한 경우 CASE를 이용가능
```SQL
SELECT 컬럼명
    FROM 테이블명
ORDER BY (
    CASE 컬럼명
        WHEN 조건A THEN 1
        WHEN 조건B THEN 2
        ELSE 3
    END
);
```
### 5)SELECT 문장 실행 순서
`GROUP BY`절과 `ORDER BY`절이 같이 사용될 때 SELECT 문장은 6개의 절로 구성되고 다음 순서대로 실행된다.
```SQL
SELECT              -- 5
    FROM            -- 1
WHERE               -- 2
    GROUP BY        -- 3
HAVING              -- 4
    ORDER BY        -- 6
```
|실행순서|절|설명|
|:-:|:-:|-|
|1|FROM|조회 대상 테이블을 참조|
|2|WHERE|조회 대상 데이터가 아니면 제거|
|3|GROUP BY|행들을 소그룹화|
|4|HAVING|그룹핑 된 값의 조건에 맞는 것들을 출력|
|5|SELECT|데이터의 값을 출력/계산|
|6|ORDER BY|데이터를 정렬|
## 조인
### 조인의 개념
>여러 개의 테이블을 연결 해 데이터를 출력하는 것
### EQUI JOIN(동등 조인)
>두 테이블 간에 컬럼 값들이 서로 정확하게 일치하는 경우에 사용되는 방법

- 조인의 조건은 WHERE절에 작성하고 `=`연산자를 이용해 표현
```SQL
SELECT 테이블1.컬럼명, 테이블2.컬럼명, ...  -- 조회할 컬럼명들 명시
    FROM 테이블1, 테이블2                -- 조인에 참여할 테이블
WHERE 테이블1.컬럼명1 = 테이블2.컬럼명2;     -- 조인 조건 명시
```
### NON-EQUI JOIN
>두 테이블 간에 컬럼 값들이 서로 정확하게 일치하지 않는 경우에 사용되는 방법

- `BETWEEN`, `>`, `<`, `>=`, `<=`등의 연산자를 이용해 표현